# Chet.QuartzNet.UI

## é¡¹ç›®ç®€ä»‹

Chet.QuartzNet.UI æ˜¯ä¸€ä¸ªåŸºäº .NET 8.0 å¼€å‘çš„è½»é‡çº§ Quartz.Net å¯è§†åŒ–ç®¡ç† UI ç»„ä»¶åº“ï¼Œæä¾›äº†å®Œæ•´çš„ä»»åŠ¡è°ƒåº¦ç®¡ç†åŠŸèƒ½ï¼Œæ”¯æŒæ–‡ä»¶å­˜å‚¨å’Œæ•°æ®åº“å­˜å‚¨ä¸¤ç§æ¨¡å¼ã€‚è¯¥ç»„ä»¶åº“æ—¨åœ¨ç®€åŒ– Quartz.Net çš„ä½¿ç”¨é—¨æ§›ï¼Œæä¾›ç›´è§‚ã€æ˜“ç”¨çš„å¯è§†åŒ–ç®¡ç†ç•Œé¢ï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿè½»æ¾åœ°åˆ›å»ºã€ç®¡ç†ã€ç›‘æ§å’Œè°ƒè¯•å®šæ—¶ä½œä¸šï¼Œæ— éœ€æ·±å…¥äº†è§£ Quartz.Net çš„å¤æ‚ APIã€‚

é€šè¿‡ Chet.QuartzNet.UIï¼Œæ‚¨å¯ä»¥å¿«é€Ÿé›†æˆä»»åŠ¡è°ƒåº¦åŠŸèƒ½åˆ°ç°æœ‰é¡¹ç›®ä¸­ï¼Œå®ç°ä½œä¸šçš„å¯è§†åŒ–é…ç½®ã€å®æ—¶ç›‘æ§å’Œå†å²è®°å½•æŸ¥è¯¢ï¼Œå¤§å¤§æé«˜å¼€å‘æ•ˆç‡å’Œè¿ç»´ä¾¿åˆ©æ€§ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ”§ **å¯è§†åŒ–ç®¡ç† Quartz ä½œä¸š**ï¼šé€šè¿‡ Web ç•Œé¢ç®¡ç† Quartz ä½œä¸šã€è§¦å‘å™¨å’Œè°ƒåº¦å™¨
- ğŸ“Š **å®æ—¶ç›‘æ§**ï¼šå®æ—¶æŸ¥çœ‹ä½œä¸šæ‰§è¡ŒçŠ¶æ€å’Œæ—¥å¿—
- ğŸ¯ **ClassJob æ¨¡å¼æ”¯æŒ**ï¼šæ”¯æŒåŸºäºç±»çš„ä½œä¸šå®šä¹‰ï¼Œç®€åŒ–ä½œä¸šåˆ›å»º
- âœ… **ClassJob è‡ªåŠ¨æ³¨å†Œ**ï¼šè‡ªåŠ¨æ‰«æå’Œæ³¨å†Œå¸¦æœ‰ç‰¹å®šç‰¹æ€§çš„ä½œä¸šç±»
- ï¿½ **å¤šç§å­˜å‚¨æ–¹å¼**ï¼šæ”¯æŒæ–‡ä»¶å­˜å‚¨å’Œæ•°æ®åº“å­˜å‚¨ï¼ˆMySQLã€PostgreSQLã€SQL Serverã€SQLiteï¼‰
- ğŸ” **è®¤è¯ä¿æŠ¤**ï¼šæä¾› JWT è®¤è¯ä¿æŠ¤ç®¡ç†ç•Œé¢
- ğŸ“¦ **RCL æ‰“åŒ…**ï¼šä½¿ç”¨ Razor Class Library æ‰“åŒ…ï¼Œæ— ä¾µå…¥é›†æˆ
- ğŸš€ **å¿«é€Ÿé›†æˆ**ï¼šç®€å•é…ç½®å³å¯é›†æˆåˆ°ç°æœ‰é¡¹ç›®
- ğŸ¨ **ç°ä»£åŒ– UI**ï¼šåŸºäº Ant Design Vueï¼Œç•Œé¢ç¾è§‚æ˜“ç”¨
- ğŸ“± **å“åº”å¼è®¾è®¡**ï¼šæ”¯æŒç§»åŠ¨ç«¯è®¿é—®
- ğŸŒ™ **æš—è‰²ä¸»é¢˜**ï¼šæ”¯æŒç³»ç»Ÿæš—è‰²ä¸»é¢˜
- ğŸ“ **ä½œä¸šæ‰§è¡Œå†å²**ï¼šè®°å½•ä½œä¸šæ‰§è¡Œå†å²å’Œç»“æœ
- ğŸ¯ **æ•°æ®åŒæ­¥åŠŸèƒ½**ï¼šæ”¯æŒæ•°æ®åŒæ­¥ä½œä¸šç¤ºä¾‹
- ğŸ“Š **æŠ¥è¡¨ç”ŸæˆåŠŸèƒ½**ï¼šæ”¯æŒæŠ¥è¡¨ç”Ÿæˆä½œä¸šç¤ºä¾‹
- â±ï¸ **çµæ´»çš„æ—¶é—´è°ƒåº¦**ï¼šæ”¯æŒ Cron è¡¨è¾¾å¼å’Œå¤šç§è§¦å‘å™¨ç±»å‹

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£… NuGet åŒ…

æ ¹æ®éœ€è¦é€‰æ‹©å®‰è£…çš„åŒ…ï¼š

```bash
# ä¸»åŒ…ï¼ˆåŒ…å«æ ¸å¿ƒåŠŸèƒ½å’Œæ–‡ä»¶å­˜å‚¨ï¼‰
dotnet add package Chet.QuartzNet.UI

# å¦‚æœéœ€è¦æ•°æ®åº“å­˜å‚¨æ”¯æŒ
dotnet add package Chet.QuartzNet.EFCore

# æ•°æ®åº“æä¾›ç¨‹åºï¼ˆæ ¹æ®éœ€è¦é€‰æ‹©ï¼‰
dotnet add package Pomelo.EntityFrameworkCore.MySql        # MySQL
dotnet add package Npgsql.EntityFrameworkCore.PostgreSQL    # PostgreSQL
dotnet add package Microsoft.EntityFrameworkCore.SqlServer   # SQL Server
dotnet add package Microsoft.EntityFrameworkCore.Sqlite      # SQLite
```

### 2. åŸºæœ¬é…ç½®

#### æ–‡ä»¶å­˜å‚¨æ¨¡å¼ï¼ˆæ¨èç”¨äºè½»é‡çº§åº”ç”¨ï¼‰

```csharp
// Program.cs
// æ·»åŠ  Quartz UI æœåŠ¡ï¼ˆæ–‡ä»¶å­˜å‚¨æ¨¡å¼ï¼Œè¯»å– QuartzUI èŠ‚ï¼‰
builder.Services.AddQuartzUI(builder.Configuration);

// æ·»åŠ  ClassJob è‡ªåŠ¨æ³¨å†Œï¼ˆå¯é€‰ï¼Œç”¨äºè‡ªåŠ¨æ‰«æä½œä¸šç±»ï¼‰
builder.Services.AddQuartzClassJobs();

// å¯ç”¨ä¸­é—´ä»¶
app.UseQuartz();
```

#### æ•°æ®åº“å­˜å‚¨æ¨¡å¼ï¼ˆæ¨èç”¨äºä¸­å¤§å‹åº”ç”¨ï¼‰

```csharp
// Program.cs
// æ·»åŠ  Quartz UI æœåŠ¡ï¼ˆStorageType=Databaseï¼ŒDatabaseProvider=SqlServerï¼Œè¯»å– ConnectionStrings:QuartzUIï¼‰
builder.Services.AddQuartzUI(builder.Configuration);

// æ·»åŠ  ClassJob è‡ªåŠ¨æ³¨å†Œï¼ˆå¯é€‰ï¼‰
builder.Services.AddQuartzClassJobs();

// å¯ç”¨ä¸­é—´ä»¶
app.UseQuartz();
```

### 3. é…ç½® ClassJob

åˆ›å»ºä¸€ä¸ªä½œä¸šç±»å¹¶æ·»åŠ  `[QuartzJob]` ç‰¹æ€§ï¼š

```csharp
using Chet.QuartzNet.Core.Attributes;
using Quartz;

[QuartzJob("SampleJob", "DEFAULT", "0 0/5 * * * ?", Description = "è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ä½œä¸šï¼Œæ¯5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡")]
public class SampleJob : IJob
{
    private readonly ILogger<SampleJob> _logger;

    public SampleJob(ILogger<SampleJob> logger)
    {
        _logger = logger;
    }

    public async Task Execute(IJobExecutionContext context)
    {
        _logger.LogInformation("SampleJobå¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡Œæ—¶é—´: {ExecuteTime}", DateTime.Now);

        try
        {
            // ä¸šåŠ¡é€»è¾‘å¤„ç†
            await Task.Delay(1000);

            // è·å–ä½œä¸šæ•°æ®
            var jobData = context.JobDetail.JobDataMap;
            if (jobData.ContainsKey("customData"))
            {
                _logger.LogInformation("è·å–åˆ°è‡ªå®šä¹‰æ•°æ®: {CustomData}", jobData.GetString("customData"));
            }

            _logger.LogInformation("SampleJobæ‰§è¡Œå®Œæˆ");
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "SampleJobæ‰§è¡Œå¤±è´¥");
            throw;
        }
    }
}
```

### 4. é…ç½®è®¤è¯ï¼ˆå¯é€‰ï¼‰

```csharp
// Program.cs
// æ·»åŠ  Quartz UI æœåŠ¡æ—¶è‡ªåŠ¨å¯ç”¨ JWT è®¤è¯ï¼ˆè¯»å– QuartzUI èŠ‚ï¼‰
builder.Services.AddQuartzUI(builder.Configuration);

// å¯ç”¨ä¸­é—´ä»¶
app.UseQuartz();
```

é…ç½®æ–‡ä»¶ï¼š

```json
// appsettings.json
"QuartzUI": {
  "EnableJwtAuth": true,
  "UserName": "Admin",
  "Password": "123456",
  "JwtSecret": "your-secret-key-change-this-in-production",
  "JwtExpiresInMinutes": 30,
  "JwtIssuer": "Chet",
  "JwtAudience": "Chet.QuartzNet.UI"
}
```

### 5. è®¿é—®ç®¡ç†ç•Œé¢

å¯åŠ¨åº”ç”¨åï¼Œè®¿é—® `/quartz-ui` å³å¯è¿›å…¥ç®¡ç†ç•Œé¢ã€‚

å¦‚æœå¯ç”¨äº†è®¤è¯ï¼Œéœ€è¦è¾“å…¥é…ç½®çš„ç”¨æˆ·åå’Œå¯†ç ã€‚

## æ•°æ®åº“å­˜å‚¨é…ç½®

### MySQL

```csharp
// å®‰è£… Pomelo.EntityFrameworkCore.MySql
dotnet add package Pomelo.EntityFrameworkCore.MySql

// é…ç½®æœåŠ¡ï¼ˆappsettings è®¾ç½® StorageType=Databaseï¼ŒDatabaseProvider=MySqlï¼ŒConnectionStrings:QuartzUIï¼‰
builder.Services.AddQuartzUI(builder.Configuration);
```

### PostgreSQL

```csharp
// å®‰è£… Npgsql.EntityFrameworkCore.PostgreSQL
dotnet add package Npgsql.EntityFrameworkCore.PostgreSQL

// é…ç½®æœåŠ¡ï¼ˆDatabaseProvider=PostgreSqlï¼‰
builder.Services.AddQuartzUI(builder.Configuration);
```

### SQL Server

```csharp
// å®‰è£… Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.SqlServer

// é…ç½®æœåŠ¡ï¼ˆDatabaseProvider=SqlServerï¼‰
builder.Services.AddQuartzUI(builder.Configuration);
```

### SQLite

```csharp
// å®‰è£… Microsoft.EntityFrameworkCore.Sqlite
dotnet add package Microsoft.EntityFrameworkCore.Sqlite

// é…ç½®æœåŠ¡ï¼ˆDatabaseProvider=SQLiteï¼‰
builder.Services.AddQuartzUI(builder.Configuration);
```

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ Chet.QuartzNet.Core/            # æ ¸å¿ƒæœåŠ¡å’ŒåŠŸèƒ½
â”‚   â”œâ”€â”€ Attributes/                 # ä½œä¸šç‰¹æ€§å®šä¹‰
â”‚   â”œâ”€â”€ Configuration/              # é…ç½®ç±»
â”‚   â”œâ”€â”€ Interfaces/                 # æ¥å£å®šä¹‰
â”‚   â”œâ”€â”€ Jobs/                       # ä½œä¸šç›¸å…³åŠŸèƒ½
â”‚   â””â”€â”€ Services/                   # æ ¸å¿ƒæœåŠ¡å®ç°
â”œâ”€â”€ Chet.QuartzNet.EFCore/          # EF Core æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ Data/                       # æ•°æ®åº“ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ Extensions/                 # æ‰©å±•æ–¹æ³•
â”‚   â”œâ”€â”€ Migrations/                 # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ Services/                   # æ•°æ®åº“å­˜å‚¨æœåŠ¡
â”œâ”€â”€ Chet.QuartzNet.Models/          # æ•°æ®æ¨¡å‹å’Œ DTO
â”‚   â”œâ”€â”€ DTOs/                       # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â””â”€â”€ Entities/                   # å®ä½“ç±»
â””â”€â”€ Chet.QuartzNet.UI/              # UI ç»„ä»¶å’Œæ§åˆ¶å™¨
    â”œâ”€â”€ Controllers/                # API æ§åˆ¶å™¨
    â”œâ”€â”€ Extensions/                 # æ‰©å±•æ–¹æ³•
    â”œâ”€â”€ Middleware/                 # ä¸­é—´ä»¶
    â””â”€â”€ wwwroot/                    # é™æ€èµ„æº

examples/
â”œâ”€â”€ Chet.QuartzNet.Example/         # æ–‡ä»¶å­˜å‚¨ç¤ºä¾‹é¡¹ç›®
â””â”€â”€ Chet.QuartzNet.Test/            # æ•°æ®åº“å­˜å‚¨ç¤ºä¾‹é¡¹ç›®
```

## ä¾èµ–é¡¹

- .NET 8.0
- Quartz.NET 3.8.1+ - ä½œä¸šè°ƒåº¦æ ¸å¿ƒåº“
- ASP.NET Core 8.0+ - Web åº”ç”¨æ¡†æ¶
- Entity Framework Core 8.0+ - æ•°æ®åº“è®¿é—®æ¡†æ¶
- Ant Design Vue - UI ç»„ä»¶åº“
- Vue.js - å‰ç«¯æ¡†æ¶

## æŠ€æœ¯æ ˆ

- **åç«¯**ï¼šC# .NET 8.0, ASP.NET Core
- **å‰ç«¯**ï¼šVue.js 3, Ant Design Vue
- **æ•°æ®å­˜å‚¨**ï¼šæ–‡ä»¶å­˜å‚¨, SQL Server, MySQL, PostgreSQL, SQLite
- **ORM**ï¼šEntity Framework Core
- **ä½œä¸šè°ƒåº¦**ï¼šQuartz.NET

## è®¸å¯è¯

MIT License

## æ›´å¤šä¿¡æ¯

è¯·æŸ¥çœ‹é¡¹ç›®æ ¹ç›®å½•çš„ [README.md](README.md) æ–‡ä»¶è·å–å®Œæ•´æ–‡æ¡£ã€‚